[2021-03-23 19:34:51,377] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: Model-Training-Pipeline.TrainBertModel 2021-03-23T23:34:21.898848+00:00 [queued]>
[2021-03-23 19:34:51,394] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: Model-Training-Pipeline.TrainBertModel 2021-03-23T23:34:21.898848+00:00 [queued]>
[2021-03-23 19:34:51,395] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2021-03-23 19:34:51,395] {taskinstance.py:1043} INFO - Starting attempt 1 of 1
[2021-03-23 19:34:51,395] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2021-03-23 19:34:51,408] {taskinstance.py:1063} INFO - Executing <Task(PythonOperator): TrainBertModel> on 2021-03-23T23:34:21.898848+00:00
[2021-03-23 19:34:51,414] {standard_task_runner.py:52} INFO - Started process 13843 to run task
[2021-03-23 19:34:51,425] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'Model-Training-Pipeline', 'TrainBertModel', '2021-03-23T23:34:21.898848+00:00', '--job-id', '38', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/train.py', '--cfg-path', '/var/folders/j6/755w2l7n4x1c9313788klj880000gq/T/tmp6oz_1r4l', '--error-file', '/var/folders/j6/755w2l7n4x1c9313788klj880000gq/T/tmpqdmmfwfq']
[2021-03-23 19:34:51,428] {standard_task_runner.py:77} INFO - Job 38: Subtask TrainBertModel
[2021-03-23 19:34:51,485] {logging_mixin.py:104} INFO - Running <TaskInstance: Model-Training-Pipeline.TrainBertModel 2021-03-23T23:34:21.898848+00:00 [running]> on host 152.1.168.192.in-addr.arpa
[2021-03-23 19:34:51,531] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=Model-Training-Pipeline
AIRFLOW_CTX_TASK_ID=TrainBertModel
AIRFLOW_CTX_EXECUTION_DATE=2021-03-23T23:34:21.898848+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2021-03-23T23:34:21.898848+00:00
[2021-03-23 19:34:52,042] {logging_mixin.py:104} INFO - Found 4194 files belonging to 2 classes.
[2021-03-23 19:34:52,066] {logging_mixin.py:104} INFO - Using 3356 files for training.
[2021-03-23 19:34:52,605] {logging_mixin.py:104} INFO - Found 4194 files belonging to 2 classes.
[2021-03-23 19:34:52,662] {logging_mixin.py:104} INFO - Using 838 files for validation.
[2021-03-23 19:34:52,779] {logging_mixin.py:104} INFO - Found 1048 files belonging to 2 classes.
[2021-03-23 19:34:52,895] {logging_mixin.py:104} INFO - BERT model selected: https://tfhub.dev/tensorflow/small_bert/bert_en_uncased_L-4_H-512_A-8/1
[2021-03-23 19:34:52,896] {logging_mixin.py:104} INFO - Preprocess model auto-selected: https://tfhub.dev/tensorflow/bert_en_uncased_preprocess/3
[2021-03-23 19:34:52,905] {resolver.py:106} INFO - Using /var/folders/j6/755w2l7n4x1c9313788klj880000gq/T/tfhub_modules to cache modules.
[2021-03-23 19:35:23,338] {optimization.py:89} INFO - using Adamw optimizer
[2021-03-23 19:35:23,340] {optimization.py:142} INFO - gradient_clip_norm=1.000000
[2021-03-23 19:35:23,352] {logging_mixin.py:104} INFO - Training model with https://tfhub.dev/tensorflow/small_bert/bert_en_uncased_L-4_H-512_A-8/1
[2021-03-23 19:35:56,811] {logging_mixin.py:104} INFO -   1/105 [..............................] - ETA: 57:55 - loss: 0.7007 - binary_accuracy: 0.4062
[2021-03-23 19:36:06,055] {logging_mixin.py:104} INFO -   2/105 [..............................] - ETA: 15:52 - loss: 0.6879 - binary_accuracy: 0.4297
[2021-03-23 19:36:15,420] {logging_mixin.py:104} INFO -   3/105 [..............................] - ETA: 15:48 - loss: 0.6878 - binary_accuracy: 0.4219
[2021-03-23 19:36:25,590] {logging_mixin.py:104} INFO -   4/105 [>.............................] - ETA: 16:08 - loss: 0.6841 - binary_accuracy: 0.4258
[2021-03-23 19:36:34,753] {logging_mixin.py:104} INFO -   5/105 [>.............................] - ETA: 15:48 - loss: 0.6808 - binary_accuracy: 0.4269
[2021-03-23 19:36:43,449] {logging_mixin.py:104} INFO -   6/105 [>.............................] - ETA: 15:23 - loss: 0.6793 - binary_accuracy: 0.4295
[2021-03-23 19:36:52,068] {logging_mixin.py:104} INFO -   7/105 [=>............................] - ETA: 15:02 - loss: 0.6796 - binary_accuracy: 0.4313
[2021-03-23 19:36:59,681] {logging_mixin.py:104} INFO -   8/105 [=>............................] - ETA: 14:31 - loss: 0.6792 - binary_accuracy: 0.4350
[2021-03-23 19:37:08,170] {logging_mixin.py:104} INFO -   9/105 [=>............................] - ETA: 14:16 - loss: 0.6775 - binary_accuracy: 0.4418
[2021-03-23 19:37:16,750] {logging_mixin.py:104} INFO -  10/105 [=>............................] - ETA: 14:03 - loss: 0.6770 - binary_accuracy: 0.4486
[2021-03-23 19:37:25,326] {logging_mixin.py:104} INFO -  11/105 [==>...........................] - ETA: 13:52 - loss: 0.6767 - binary_accuracy: 0.4556
[2021-03-23 19:37:32,659] {logging_mixin.py:104} INFO -  12/105 [==>...........................] - ETA: 13:30 - loss: 0.6752 - binary_accuracy: 0.4630
[2021-03-23 19:37:43,194] {logging_mixin.py:104} INFO -  13/105 [==>...........................] - ETA: 13:35 - loss: 0.6740 - binary_accuracy: 0.4699
[2021-03-23 19:37:52,751] {logging_mixin.py:104} INFO -  14/105 [===>..........................] - ETA: 13:31 - loss: 0.6728 - binary_accuracy: 0.4759
[2021-03-23 19:38:02,110] {logging_mixin.py:104} INFO -  15/105 [===>..........................] - ETA: 13:25 - loss: 0.6714 - binary_accuracy: 0.4812
[2021-03-23 19:38:11,370] {logging_mixin.py:104} INFO -  16/105 [===>..........................] - ETA: 13:18 - loss: 0.6695 - binary_accuracy: 0.4864
[2021-03-23 19:38:20,322] {logging_mixin.py:104} INFO -  17/105 [===>..........................] - ETA: 13:09 - loss: 0.6676 - binary_accuracy: 0.4916
[2021-03-23 19:38:28,807] {logging_mixin.py:104} INFO -  18/105 [====>.........................] - ETA: 12:57 - loss: 0.6658 - binary_accuracy: 0.4960
[2021-03-23 19:38:37,020] {logging_mixin.py:104} INFO -  19/105 [====>.........................] - ETA: 12:45 - loss: 0.6639 - binary_accuracy: 0.5004
[2021-03-23 19:38:48,487] {logging_mixin.py:104} INFO -  20/105 [====>.........................] - ETA: 12:48 - loss: 0.6620 - binary_accuracy: 0.5047
[2021-03-23 19:38:59,832] {logging_mixin.py:104} INFO -  21/105 [=====>........................] - ETA: 12:48 - loss: 0.6599 - binary_accuracy: 0.5089
[2021-03-23 19:39:12,810] {logging_mixin.py:104} INFO -  22/105 [=====>........................] - ETA: 12:54 - loss: 0.6579 - binary_accuracy: 0.5130
[2021-03-23 19:39:23,188] {logging_mixin.py:104} INFO -  23/105 [=====>........................] - ETA: 12:49 - loss: 0.6558 - binary_accuracy: 0.5169
[2021-03-23 19:39:31,616] {logging_mixin.py:104} INFO -  24/105 [=====>........................] - ETA: 12:36 - loss: 0.6541 - binary_accuracy: 0.5204
[2021-03-23 19:39:41,768] {logging_mixin.py:104} INFO -  25/105 [======>.......................] - ETA: 12:29 - loss: 0.6525 - binary_accuracy: 0.5238
[2021-03-23 19:39:50,550] {logging_mixin.py:104} INFO -  26/105 [======>.......................] - ETA: 12:18 - loss: 0.6510 - binary_accuracy: 0.5272
[2021-03-23 19:39:59,982] {logging_mixin.py:104} INFO -  27/105 [======>.......................] - ETA: 12:09 - loss: 0.6494 - binary_accuracy: 0.5304
[2021-03-23 19:40:07,736] {logging_mixin.py:104} INFO -  28/105 [=======>......................] - ETA: 11:55 - loss: 0.6477 - binary_accuracy: 0.5335
[2021-03-23 19:40:16,274] {logging_mixin.py:104} INFO -  29/105 [=======>......................] - ETA: 11:44 - loss: 0.6460 - binary_accuracy: 0.5366
[2021-03-23 19:40:24,857] {logging_mixin.py:104} INFO -  30/105 [=======>......................] - ETA: 11:33 - loss: 0.6442 - binary_accuracy: 0.5398
[2021-03-23 19:40:33,469] {logging_mixin.py:104} INFO -  31/105 [=======>......................] - ETA: 11:22 - loss: 0.6423 - binary_accuracy: 0.5430
[2021-03-23 19:40:40,979] {logging_mixin.py:104} INFO -  32/105 [========>.....................] - ETA: 11:09 - loss: 0.6405 - binary_accuracy: 0.5462
[2021-03-23 19:40:49,793] {logging_mixin.py:104} INFO -  33/105 [========>.....................] - ETA: 10:59 - loss: 0.6387 - binary_accuracy: 0.5493
[2021-03-23 19:40:58,034] {logging_mixin.py:104} INFO -  34/105 [========>.....................] - ETA: 10:48 - loss: 0.6370 - binary_accuracy: 0.5522
[2021-03-23 19:41:06,363] {logging_mixin.py:104} INFO -  35/105 [=========>....................] - ETA: 10:37 - loss: 0.6353 - binary_accuracy: 0.5551
[2021-03-23 19:41:14,417] {logging_mixin.py:104} INFO -  36/105 [=========>....................] - ETA: 10:26 - loss: 0.6336 - binary_accuracy: 0.5580
[2021-03-23 19:41:23,564] {logging_mixin.py:104} INFO -  37/105 [=========>....................] - ETA: 10:17 - loss: 0.6320 - binary_accuracy: 0.5607
[2021-03-23 19:41:32,395] {logging_mixin.py:104} INFO -  38/105 [=========>....................] - ETA: 10:07 - loss: 0.6304 - binary_accuracy: 0.5633
[2021-03-23 19:41:40,138] {logging_mixin.py:104} INFO -  39/105 [==========>...................] - ETA: 9:56 - loss: 0.6289 - binary_accuracy: 0.5658 
[2021-03-23 19:41:49,323] {logging_mixin.py:104} INFO -  40/105 [==========>...................] - ETA: 9:47 - loss: 0.6273 - binary_accuracy: 0.5683
[2021-03-23 19:41:59,884] {logging_mixin.py:104} INFO -  41/105 [==========>...................] - ETA: 9:40 - loss: 0.6256 - binary_accuracy: 0.5708
[2021-03-23 19:42:09,241] {logging_mixin.py:104} INFO -  42/105 [===========>..................] - ETA: 9:32 - loss: 0.6240 - binary_accuracy: 0.5733
[2021-03-23 19:42:23,347] {logging_mixin.py:104} INFO -  43/105 [===========>..................] - ETA: 9:30 - loss: 0.6223 - binary_accuracy: 0.5757
[2021-03-23 19:42:34,278] {logging_mixin.py:104} INFO -  44/105 [===========>..................] - ETA: 9:23 - loss: 0.6206 - binary_accuracy: 0.5780
[2021-03-23 19:42:44,309] {logging_mixin.py:104} INFO -  45/105 [===========>..................] - ETA: 9:15 - loss: 0.6190 - binary_accuracy: 0.5803
[2021-03-23 19:42:53,476] {logging_mixin.py:104} INFO -  46/105 [============>.................] - ETA: 9:06 - loss: 0.6174 - binary_accuracy: 0.5825
[2021-03-23 19:43:04,209] {logging_mixin.py:104} INFO -  47/105 [============>.................] - ETA: 8:58 - loss: 0.6158 - binary_accuracy: 0.5847
[2021-03-23 19:43:13,249] {logging_mixin.py:104} INFO -  48/105 [============>.................] - ETA: 8:49 - loss: 0.6143 - binary_accuracy: 0.5868
[2021-03-23 19:43:21,301] {logging_mixin.py:104} INFO -  49/105 [=============>................] - ETA: 8:38 - loss: 0.6129 - binary_accuracy: 0.5889
[2021-03-23 19:43:30,345] {logging_mixin.py:104} INFO -  50/105 [=============>................] - ETA: 8:29 - loss: 0.6114 - binary_accuracy: 0.5908
[2021-03-23 19:43:39,321] {logging_mixin.py:104} INFO -  51/105 [=============>................] - ETA: 8:19 - loss: 0.6100 - binary_accuracy: 0.5928
[2021-03-23 19:43:48,265] {logging_mixin.py:104} INFO -  52/105 [=============>................] - ETA: 8:09 - loss: 0.6085 - binary_accuracy: 0.5947
[2021-03-23 19:43:57,061] {logging_mixin.py:104} INFO -  53/105 [==============>...............] - ETA: 8:00 - loss: 0.6071 - binary_accuracy: 0.5966
[2021-03-23 19:44:05,557] {logging_mixin.py:104} INFO -  54/105 [==============>...............] - ETA: 7:50 - loss: 0.6057 - binary_accuracy: 0.5985
[2021-03-23 19:44:14,249] {logging_mixin.py:104} INFO -  55/105 [==============>...............] - ETA: 7:40 - loss: 0.6044 - binary_accuracy: 0.6003
[2021-03-23 19:44:22,234] {logging_mixin.py:104} INFO -  56/105 [===============>..............] - ETA: 7:30 - loss: 0.6030 - binary_accuracy: 0.6020
[2021-03-23 19:44:31,866] {logging_mixin.py:104} INFO -  57/105 [===============>..............] - ETA: 7:21 - loss: 0.6017 - binary_accuracy: 0.6038
[2021-03-23 19:44:40,946] {logging_mixin.py:104} INFO -  58/105 [===============>..............] - ETA: 7:12 - loss: 0.6004 - binary_accuracy: 0.6055
[2021-03-23 19:44:48,733] {logging_mixin.py:104} INFO -  59/105 [===============>..............] - ETA: 7:01 - loss: 0.5991 - binary_accuracy: 0.6071
[2021-03-23 19:44:58,366] {logging_mixin.py:104} INFO -  60/105 [================>.............] - ETA: 6:53 - loss: 0.5978 - binary_accuracy: 0.6088
[2021-03-23 19:45:09,237] {logging_mixin.py:104} INFO -  61/105 [================>.............] - ETA: 6:45 - loss: 0.5966 - binary_accuracy: 0.6104
[2021-03-23 19:45:17,289] {logging_mixin.py:104} INFO -  62/105 [================>.............] - ETA: 6:35 - loss: 0.5953 - binary_accuracy: 0.6119
[2021-03-23 19:45:27,540] {logging_mixin.py:104} INFO -  63/105 [=================>............] - ETA: 6:26 - loss: 0.5941 - binary_accuracy: 0.6135
[2021-03-23 19:45:40,831] {logging_mixin.py:104} INFO -  64/105 [=================>............] - ETA: 6:20 - loss: 0.5930 - binary_accuracy: 0.6150
[2021-03-23 19:45:54,485] {logging_mixin.py:104} INFO -  65/105 [=================>............] - ETA: 6:13 - loss: 0.5919 - binary_accuracy: 0.6164
[2021-03-23 19:46:03,661] {logging_mixin.py:104} INFO -  66/105 [=================>............] - ETA: 6:04 - loss: 0.5908 - binary_accuracy: 0.6178
[2021-03-23 19:46:13,082] {logging_mixin.py:104} INFO -  67/105 [==================>...........] - ETA: 5:54 - loss: 0.5898 - binary_accuracy: 0.6192
[2021-03-23 19:46:21,776] {logging_mixin.py:104} INFO -  68/105 [==================>...........] - ETA: 5:45 - loss: 0.5889 - binary_accuracy: 0.6205
[2021-03-23 19:46:31,917] {logging_mixin.py:104} INFO -  69/105 [==================>...........] - ETA: 5:36 - loss: 0.5879 - binary_accuracy: 0.6218
[2021-03-23 19:46:43,333] {logging_mixin.py:104} INFO -  70/105 [===================>..........] - ETA: 5:27 - loss: 0.5869 - binary_accuracy: 0.6232
[2021-03-23 19:46:52,672] {logging_mixin.py:104} INFO -  71/105 [===================>..........] - ETA: 5:18 - loss: 0.5860 - binary_accuracy: 0.6244
[2021-03-23 19:47:01,251] {logging_mixin.py:104} INFO -  72/105 [===================>..........] - ETA: 5:08 - loss: 0.5851 - binary_accuracy: 0.6257
[2021-03-23 19:47:10,870] {logging_mixin.py:104} INFO -  73/105 [===================>..........] - ETA: 4:59 - loss: 0.5842 - binary_accuracy: 0.6270
[2021-03-23 19:47:19,123] {logging_mixin.py:104} INFO -  74/105 [====================>.........] - ETA: 4:49 - loss: 0.5832 - binary_accuracy: 0.6282
[2021-03-23 19:47:27,798] {logging_mixin.py:104} INFO -  75/105 [====================>.........] - ETA: 4:40 - loss: 0.5823 - binary_accuracy: 0.6294
[2021-03-23 19:47:35,909] {logging_mixin.py:104} INFO -  76/105 [====================>.........] - ETA: 4:30 - loss: 0.5814 - binary_accuracy: 0.6307
[2021-03-23 19:47:45,571] {logging_mixin.py:104} INFO -  77/105 [=====================>........] - ETA: 4:21 - loss: 0.5805 - binary_accuracy: 0.6318
[2021-03-23 19:47:55,868] {logging_mixin.py:104} INFO -  78/105 [=====================>........] - ETA: 4:12 - loss: 0.5797 - binary_accuracy: 0.6330
[2021-03-23 19:48:05,428] {logging_mixin.py:104} INFO -  79/105 [=====================>........] - ETA: 4:02 - loss: 0.5788 - binary_accuracy: 0.6341
[2021-03-23 19:48:16,162] {logging_mixin.py:104} INFO -  80/105 [=====================>........] - ETA: 3:53 - loss: 0.5780 - binary_accuracy: 0.6352
[2021-03-23 19:48:25,629] {logging_mixin.py:104} INFO -  81/105 [======================>.......] - ETA: 3:44 - loss: 0.5771 - binary_accuracy: 0.6363
[2021-03-23 19:48:33,734] {logging_mixin.py:104} INFO -  82/105 [======================>.......] - ETA: 3:34 - loss: 0.5763 - binary_accuracy: 0.6373
[2021-03-23 19:48:44,778] {logging_mixin.py:104} INFO -  83/105 [======================>.......] - ETA: 3:26 - loss: 0.5755 - binary_accuracy: 0.6384
[2021-03-23 19:48:53,456] {logging_mixin.py:104} INFO -  84/105 [=======================>......] - ETA: 3:16 - loss: 0.5747 - binary_accuracy: 0.6394
[2021-03-23 19:49:01,456] {logging_mixin.py:104} INFO -  85/105 [=======================>......] - ETA: 3:06 - loss: 0.5739 - binary_accuracy: 0.6404
[2021-03-23 19:49:09,785] {logging_mixin.py:104} INFO -  86/105 [=======================>......] - ETA: 2:57 - loss: 0.5731 - binary_accuracy: 0.6414
[2021-03-23 19:49:18,665] {logging_mixin.py:104} INFO -  87/105 [=======================>......] - ETA: 2:47 - loss: 0.5724 - binary_accuracy: 0.6424
[2021-03-23 19:49:27,394] {logging_mixin.py:104} INFO -  88/105 [========================>.....] - ETA: 2:38 - loss: 0.5716 - binary_accuracy: 0.6434
[2021-03-23 19:49:34,966] {logging_mixin.py:104} INFO -  89/105 [========================>.....] - ETA: 2:28 - loss: 0.5709 - binary_accuracy: 0.6443
[2021-03-23 19:49:44,818] {logging_mixin.py:104} INFO -  90/105 [========================>.....] - ETA: 2:19 - loss: 0.5701 - binary_accuracy: 0.6453
[2021-03-23 19:49:53,545] {logging_mixin.py:104} INFO -  91/105 [=========================>....] - ETA: 2:10 - loss: 0.5694 - binary_accuracy: 0.6462
[2021-03-23 19:50:02,091] {logging_mixin.py:104} INFO -  92/105 [=========================>....] - ETA: 2:00 - loss: 0.5687 - binary_accuracy: 0.6471
[2021-03-23 19:50:10,423] {logging_mixin.py:104} INFO -  93/105 [=========================>....] - ETA: 1:51 - loss: 0.5680 - binary_accuracy: 0.6479
[2021-03-23 19:50:19,218] {logging_mixin.py:104} INFO -  94/105 [=========================>....] - ETA: 1:42 - loss: 0.5674 - binary_accuracy: 0.6488
[2021-03-23 19:50:27,803] {logging_mixin.py:104} INFO -  95/105 [==========================>...] - ETA: 1:32 - loss: 0.5667 - binary_accuracy: 0.6497
[2021-03-23 19:50:35,211] {logging_mixin.py:104} INFO -  96/105 [==========================>...] - ETA: 1:23 - loss: 0.5660 - binary_accuracy: 0.6505
[2021-03-23 19:50:44,270] {logging_mixin.py:104} INFO -  97/105 [==========================>...] - ETA: 1:13 - loss: 0.5654 - binary_accuracy: 0.6513
[2021-03-23 19:50:53,437] {logging_mixin.py:104} INFO -  98/105 [===========================>..] - ETA: 1:04 - loss: 0.5647 - binary_accuracy: 0.6522
[2021-03-23 19:51:01,785] {logging_mixin.py:104} INFO -  99/105 [===========================>..] - ETA: 55s - loss: 0.5640 - binary_accuracy: 0.6530 
[2021-03-23 19:51:09,793] {logging_mixin.py:104} INFO - 100/105 [===========================>..] - ETA: 46s - loss: 0.5634 - binary_accuracy: 0.6538
[2021-03-23 19:51:18,997] {logging_mixin.py:104} INFO - 101/105 [===========================>..] - ETA: 36s - loss: 0.5628 - binary_accuracy: 0.6546
[2021-03-23 19:51:29,657] {logging_mixin.py:104} INFO - 102/105 [============================>.] - ETA: 27s - loss: 0.5622 - binary_accuracy: 0.6553
[2021-03-23 19:51:42,778] {logging_mixin.py:104} INFO - 103/105 [============================>.] - ETA: 18s - loss: 0.5616 - binary_accuracy: 0.6561
[2021-03-23 19:51:52,075] {logging_mixin.py:104} INFO - 104/105 [============================>.] - ETA: 9s - loss: 0.5610 - binary_accuracy: 0.6568 
[2021-03-23 19:52:02,217] {logging_mixin.py:104} INFO - 105/105 [==============================] - ETA: 0s - loss: 0.5604 - binary_accuracy: 0.6575
[2021-03-23 19:53:49,934] {logging_mixin.py:104} INFO - 105/105 [==============================] - 1107s 10s/step - loss: 0.5598 - binary_accuracy: 0.6582 - val_loss: 0.4754 - val_binary_accuracy: 0.7470
[2021-03-23 19:53:53,181] {logging_mixin.py:104} INFO -  1/33 [..............................] - ETA: 1:43 - loss: 0.3851 - binary_accuracy: 0.8750
[2021-03-23 19:53:55,691] {logging_mixin.py:104} INFO -  2/33 [>.............................] - ETA: 1:17 - loss: 0.3987 - binary_accuracy: 0.7969
[2021-03-23 19:53:59,024] {logging_mixin.py:104} INFO -  3/33 [=>............................] - ETA: 1:27 - loss: 0.4414 - binary_accuracy: 0.7604
[2021-03-23 19:54:02,204] {logging_mixin.py:104} INFO -  4/33 [==>...........................] - ETA: 1:27 - loss: 0.4701 - binary_accuracy: 0.7734
[2021-03-23 19:54:05,837] {logging_mixin.py:104} INFO -  5/33 [===>..........................] - ETA: 1:28 - loss: 0.5010 - binary_accuracy: 0.7563
[2021-03-23 19:54:09,083] {logging_mixin.py:104} INFO -  6/33 [====>.........................] - ETA: 1:25 - loss: 0.5049 - binary_accuracy: 0.7448
[2021-03-23 19:54:12,828] {logging_mixin.py:104} INFO -  7/33 [=====>........................] - ETA: 1:25 - loss: 0.5067 - binary_accuracy: 0.7411
[2021-03-23 19:54:16,096] {logging_mixin.py:104} INFO -  8/33 [======>.......................] - ETA: 1:21 - loss: 0.5083 - binary_accuracy: 0.7383
[2021-03-23 19:54:20,035] {logging_mixin.py:104} INFO -  9/33 [=======>......................] - ETA: 1:20 - loss: 0.5091 - binary_accuracy: 0.7292
[2021-03-23 19:54:22,458] {logging_mixin.py:104} INFO - 10/33 [========>.....................] - ETA: 1:14 - loss: 0.4946 - binary_accuracy: 0.7344
[2021-03-23 19:54:26,833] {logging_mixin.py:104} INFO - 11/33 [=========>....................] - ETA: 1:14 - loss: 0.4734 - binary_accuracy: 0.7472
[2021-03-23 19:54:31,123] {logging_mixin.py:104} INFO - 12/33 [=========>....................] - ETA: 1:12 - loss: 0.4882 - binary_accuracy: 0.7396
[2021-03-23 19:54:36,371] {logging_mixin.py:104} INFO - 13/33 [==========>...................] - ETA: 1:11 - loss: 0.4990 - binary_accuracy: 0.7428
[2021-03-23 19:54:39,771] {logging_mixin.py:104} INFO - 14/33 [===========>..................] - ETA: 1:08 - loss: 0.5036 - binary_accuracy: 0.7366
[2021-03-23 19:54:42,566] {logging_mixin.py:104} INFO - 15/33 [============>.................] - ETA: 1:03 - loss: 0.5063 - binary_accuracy: 0.7375
[2021-03-23 19:54:45,109] {logging_mixin.py:104} INFO - 16/33 [=============>................] - ETA: 58s - loss: 0.5091 - binary_accuracy: 0.7383 
[2021-03-23 19:54:47,676] {logging_mixin.py:104} INFO - 17/33 [==============>...............] - ETA: 54s - loss: 0.5113 - binary_accuracy: 0.7408
[2021-03-23 19:54:50,277] {logging_mixin.py:104} INFO - 18/33 [===============>..............] - ETA: 50s - loss: 0.5031 - binary_accuracy: 0.7483
[2021-03-23 19:54:52,764] {logging_mixin.py:104} INFO - 19/33 [================>.............] - ETA: 46s - loss: 0.5077 - binary_accuracy: 0.7467
[2021-03-23 19:54:55,666] {logging_mixin.py:104} INFO - 20/33 [=================>............] - ETA: 42s - loss: 0.5077 - binary_accuracy: 0.7437
[2021-03-23 19:54:57,812] {logging_mixin.py:104} INFO - 21/33 [==================>...........] - ETA: 38s - loss: 0.4980 - binary_accuracy: 0.7515
[2021-03-23 19:54:59,857] {logging_mixin.py:104} INFO - 22/33 [===================>..........] - ETA: 34s - loss: 0.4983 - binary_accuracy: 0.7528
[2021-03-23 19:55:01,855] {logging_mixin.py:104} INFO - 23/33 [===================>..........] - ETA: 31s - loss: 0.4937 - binary_accuracy: 0.7582
[2021-03-23 19:55:03,770] {logging_mixin.py:104} INFO - 24/33 [====================>.........] - ETA: 27s - loss: 0.5013 - binary_accuracy: 0.7539
[2021-03-23 19:55:05,719] {logging_mixin.py:104} INFO - 25/33 [=====================>........] - ETA: 24s - loss: 0.4997 - binary_accuracy: 0.7550
[2021-03-23 19:55:07,919] {logging_mixin.py:104} INFO - 26/33 [======================>.......] - ETA: 20s - loss: 0.4974 - binary_accuracy: 0.7572
[2021-03-23 19:55:10,373] {logging_mixin.py:104} INFO - 27/33 [=======================>......] - ETA: 17s - loss: 0.4927 - binary_accuracy: 0.7604
[2021-03-23 19:55:12,561] {logging_mixin.py:104} INFO - 28/33 [========================>.....] - ETA: 14s - loss: 0.4900 - binary_accuracy: 0.7600
[2021-03-23 19:55:14,977] {logging_mixin.py:104} INFO - 29/33 [=========================>....] - ETA: 11s - loss: 0.4880 - binary_accuracy: 0.7619
[2021-03-23 19:55:17,180] {logging_mixin.py:104} INFO - 30/33 [==========================>...] - ETA: 8s - loss: 0.4872 - binary_accuracy: 0.7604 
[2021-03-23 19:55:19,347] {logging_mixin.py:104} INFO - 31/33 [===========================>..] - ETA: 5s - loss: 0.4869 - binary_accuracy: 0.7591
[2021-03-23 19:55:21,625] {logging_mixin.py:104} INFO - 32/33 [============================>.] - ETA: 2s - loss: 0.4872 - binary_accuracy: 0.7607
[2021-03-23 19:55:23,330] {logging_mixin.py:104} INFO - 33/33 [==============================] - ETA: 0s - loss: 0.4834 - binary_accuracy: 0.7624
[2021-03-23 19:55:23,331] {logging_mixin.py:104} INFO - 33/33 [==============================] - 93s 3s/step - loss: 0.4834 - binary_accuracy: 0.7624
[2021-03-23 19:55:23,333] {logging_mixin.py:104} INFO - Loss: 0.48336029052734375
[2021-03-23 19:55:23,333] {logging_mixin.py:104} INFO - Accuracy: 0.7624045610427856
[2021-03-23 19:55:23,334] {logging_mixin.py:104} INFO - Failed to load a yaml file due to {e}
[2021-03-23 19:55:23,336] {taskinstance.py:1455} ERROR - local variable 'config' referenced before assignment
Traceback (most recent call last):
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/MyEnv/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1112, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/MyEnv/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1285, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/MyEnv/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1315, in _execute_task
    result = task_copy.execute(context=context)
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/MyEnv/lib/python3.7/site-packages/airflow/operators/python.py", line 117, in execute
    return_value = self.execute_callable()
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/MyEnv/lib/python3.7/site-packages/airflow/operators/python.py", line 128, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/dags/train.py", line 338, in train_model
    config= load_yaml(yaml_path)
  File "/Users/harika/Desktop/CSYE_7245/Assignment2/pipeline/dags/utils/utils.py", line 9, in load_yaml
    return config
UnboundLocalError: local variable 'config' referenced before assignment
[2021-03-23 19:55:23,345] {taskinstance.py:1503} INFO - Marking task as FAILED. dag_id=Model-Training-Pipeline, task_id=TrainBertModel, execution_date=20210323T233421, start_date=20210323T233451, end_date=20210323T235523
[2021-03-23 19:55:23,654] {local_task_job.py:146} INFO - Task exited with return code 1
